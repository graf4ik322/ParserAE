# –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤ –ò–ò

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ò–ò-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –æ—à–∏–±–∫—É:
```
üîç –ò—â—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞—Ä–æ–º–∞—Ç–µ...
–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –º–µ—Ç–æ–¥–æ–≤**:
   - –í `main.py` —Å—Ç—Ä–æ–∫–∞ 795: `await self.ai.call_openrouter_api(prompt, max_tokens=3000)`
   - –í `main.py` —Å—Ç—Ä–æ–∫–∞ 726: `await self.ai.call_openrouter_api(prompt, max_tokens=4000)`
   - –í–º–µ—Å—Ç–æ –Ω–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞ `process_message`

2. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—É–ª–¥–∞—É–Ω–∞**:
   - –í `main.py` –ø—Ä–æ–≤–µ—Ä—è–ª—Å—è –∫—É–ª–¥–∞—É–Ω –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –ò–ò
   - –í `process_message` —Å–Ω–æ–≤–∞ –ø—Ä–æ–≤–µ—Ä—è–ª—Å—è —Ç–æ—Ç –∂–µ –∫—É–ª–¥–∞—É–Ω
   - –≠—Ç–æ –º–æ–≥–ª–æ –≤—ã–∑—ã–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

3. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫—É–ª–¥–∞—É–Ω–∞**:
   - –í `main.py` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –∫—É–ª–¥–∞—É–Ω –Ω–∞ 30 —Å–µ–∫—É–Ω–¥
   - –í `process_message` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –∫—É–ª–¥–∞—É–Ω –Ω–∞ 10 —Å–µ–∫—É–Ω–¥
   - –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª –ø–µ—Ä–≤—ã–π

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ó–∞–º–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –≤—ã–∑–æ–≤–æ–≤ –ò–ò

**–§–∞–π–ª:** `main.py`

**–ë—ã–ª–æ –≤ `handle_fragrance_info`:**
```python
ai_response = await self.ai.call_openrouter_api(prompt, max_tokens=3000)
```

**–°—Ç–∞–ª–æ:**
```python
ai_response = await self.ai.process_message(prompt, user_id)
```

**–ë—ã–ª–æ –≤ `handle_perfume_question`:**
```python
ai_response = await self.ai.call_openrouter_api(prompt, max_tokens=4000)
```

**–°—Ç–∞–ª–æ:**
```python
ai_response = await self.ai.process_message(prompt, user_id)
```

### 2. –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∫—É–ª–¥–∞—É–Ω–∞

**–ë—ã–ª–æ –≤ `handle_fragrance_info`:**
```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—É–ª–¥–∞—É–Ω
if self.ai.is_api_cooldown_active(user_id):
    await update.message.reply_text("‚è±Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∑–∞–ø—Ä–æ—Å–æ–º")
    return
```

**–°—Ç–∞–ª–æ:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞ —Ç–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ process_message
# –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ –∫—É–ª–¥–∞—É–Ω–µ:
if "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ" in ai_response:
    await searching_msg.delete()
    await update.message.reply_text(ai_response)
    return
```

### 3. –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫ –∫—É–ª–¥–∞—É–Ω–∞

**–ë—ã–ª–æ –≤ –æ–±–µ–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö:**
```python
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫—É–ª–¥–∞—É–Ω
self.ai.set_api_cooldown(user_id, 30)
```

**–°—Ç–∞–ª–æ:**
```python
# –ö—É–ª–¥–∞—É–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ process_message (10 —Å–µ–∫—É–Ω–¥)
# –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä—É—é—â–µ–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```

## üîß –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞—Ä–æ–º–∞—Ç–µ:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å "Berydo –æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—ã–π —á–∞—Å"
2. **–ë–æ—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üîç –ò—â—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞—Ä–æ–º–∞—Ç–µ..."
3. **main.py:** –í—ã–∑—ã–≤–∞–µ—Ç `ai.process_message(prompt, user_id)`
4. **process_message:** 
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—É–ª–¥–∞—É–Ω (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –æ–∂–∏–¥–∞–Ω–∏–∏)
   - –í—ã–∑—ã–≤–∞–µ—Ç `call_openrouter_api(prompt)` 
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫—É–ª–¥–∞—É–Ω –Ω–∞ 10 —Å–µ–∫—É–Ω–¥
   - –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –¥–ª—è Telegram
5. **main.py:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∫—É–ª–¥–∞—É–Ω–µ
6. **–ë–æ—Ç:** –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

- ‚úÖ **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ò–ò** - –≤–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ `process_message`
- ‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ —É—Å—Ç–∞–Ω–æ–≤–æ–∫ –∫—É–ª–¥–∞—É–Ω–∞
- ‚úÖ **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** - –≤—Å–µ –≤—ã–∑–æ–≤—ã –ò–ò –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –ª–æ–≥–∏–∫—É
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ç–∞–π–º–∞—É—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø—Ä–æ–º–ø—Ç–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:
- üìä **–í—Å–µ–≥–æ –ø–∞—Ä—Ñ—é–º–æ–≤ –≤ –ë–î:** 1,205
- üìù **–°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –∑–∞–ø–∏—Å–∏:** 36.0 —Å–∏–º–≤–æ–ª–æ–≤  
- üìè **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞:** 45,380 —Å–∏–º–≤–æ–ª–æ–≤ (44.3 KB)
- ‚úÖ **–†–∞–∑–º–µ—Ä –ø—Ä–∏–µ–º–ª–µ–º—ã–π** - –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å —Ç–∞–π–º–∞—É—Ç—ã

### API –∫–ª—é—á –ø—Ä–æ–≤–µ—Ä–µ–Ω:
- üîë **–§–æ—Ä–º–∞—Ç:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π (sk-or-v1-...)
- üìè **–î–ª–∏–Ω–∞:** 73 —Å–∏–º–≤–æ–ª–∞
- ‚úÖ **–°—Ç–∞—Ç—É—Å:** –í–∞–ª–∏–¥–Ω—ã–π

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!** –¢–µ–ø–µ—Ä—å:

1. ‚úÖ **–í—Å–µ –≤—ã–∑–æ–≤—ã –ò–ò –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥** `process_message`
2. ‚úÖ **–ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∫—É–ª–¥–∞—É–Ω–∞** - –µ–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
3. ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ç–∞–π–º–∞—É—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
4. ‚úÖ **–†–∞–∑–º–µ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π** - –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ API

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

**–ó–∞–ø—Ä–æ—Å:** "Berydo –æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—ã–π —á–∞—Å"
**–û—Ç–≤–µ—Ç:** –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—Ä–æ–º–∞—Ç–µ –≤–º–µ—Å—Ç–æ —Ç–∞–π–º–∞—É—Ç–∞!

–°–∏—Å—Ç–µ–º–∞ –ò–ò —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ.