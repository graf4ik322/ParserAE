# Парсер каталога парфюмерии Aroma-Euro.ru

Финальная версия специализированного парсера для извлечения полной информации о парфюмерных композициях с сайта [aroma-euro.ru](https://aroma-euro.ru/perfume/).

## Описание

Парсер извлекает полную информацию о парфюмерии:
- **Полное название** товара
- **Бренд** (фабрика-производитель)  
- **Название** парфюма
- **URL** страницы товара
- **Цена** (если доступна)
- **Изображение** (если доступно)
- **Детальные характеристики** (описание, ноты, объемы)

Все данные сохраняются в формате JSON для последующей обработки через LLM или другие инструменты.

## Установка

1. Убедитесь, что у вас установлен Python 3.7 или выше:
```bash
python --version
```

2. Установите необходимые зависимости:
```bash
pip install -r requirements.txt
```

## Файлы проекта

### Основные парсеры:
- **`complete_parser_with_details.py`** - основной парсер с автоопределением страниц и извлечением детальных характеристик
- **`full_catalog_parser.py`** - полная версия для парсинга всех 1281 товаров каталога
- **`test_full_parser.py`** - тестирование автоопределения пагинации

### Выходные данные:
- **`full_basic_catalog.json`** - базовый каталог всех товаров (основная информация)
- **`full_perfumes_catalog_complete.json`** - полный каталог с детальными характеристиками

## Использование

### Полный парсинг каталога

Для извлечения всех товаров из каталога:
```bash
python full_catalog_parser.py
```

Этот скрипт:
- Автоматически определяет количество страниц (43 страницы)
- Извлекает информацию о всех 1281 парфюмах
- Создает два файла: базовый каталог и полный с характеристиками
- Выводит подробную статистику парсинга

### Основной парсер с деталями

Для парсинга с извлечением детальных характеристик:
```bash
python complete_parser_with_details.py
```

### Тестирование парсера

Для проверки автоопределения пагинации:
```bash
python test_full_parser.py
```

## Структура выходных данных

### Базовый каталог (`full_basic_catalog.json`)

```json
{
  "metadata": {
    "source": "aroma-euro.ru",
    "parsing_date": "2025-01-28 12:00:00",
    "total_count": 1281,
    "parser_version": "3.0"
  },
  "perfumes": [
    {
      "full_title": "Tom Ford - Black Orchid",
      "brand": "Tom Ford",
      "name": "Black Orchid",
      "url": "https://aroma-euro.ru/perfume/tom-ford-black-orchid/",
      "price": "450 ₽",
      "image": "https://aroma-euro.ru/images/thumbnails/100/100/detailed/10/product-example.jpg"
    }
  ]
}
```

### Полный каталог с характеристиками (`full_perfumes_catalog_complete.json`)

```json
{
  "metadata": {
    "source": "aroma-euro.ru",
    "parsing_date": "2025-01-28 12:00:00",
    "total_count": 1281,
    "parser_version": "3.0",
    "has_details": true
  },
  "perfumes": [
    {
      "full_title": "Tom Ford - Black Orchid",
      "brand": "Tom Ford",
      "name": "Black Orchid",
      "url": "https://aroma-euro.ru/perfume/tom-ford-black-orchid/",
      "price": "450 ₽",
      "image": "https://aroma-euro.ru/images/thumbnails/100/100/detailed/10/product-example.jpg",
      "details": {
        "description": "Роскошный восточный аромат...",
        "top_notes": ["Черная смородина", "Иланг-иланг"],
        "heart_notes": ["Черная орхидея", "Цветы сливы"],
        "base_notes": ["Черный трюфель", "Пачули", "Ваниль"],
        "volumes": ["30ml", "50ml", "100ml"],
        "concentration": "Eau de Parfum"
      }
    }
  ]
}
```

## Особенности парсера

### Автоматическое определение пагинации

Парсер автоматически:
- Определяет общее количество страниц каталога
- Обрабатывает все 43 страницы с товарами
- Извлекает все 1281 товар из каталога

### Интеллектуальное разделение названий

Парсер использует несколько стратегий для разделения полного названия на бренд и название парфюма:

1. **Паттерны с разделителями**: `Tom Ford - Black Orchid`
2. **Известные бренды**: автоматическое распознавание популярных брендов
3. **Регулярные выражения**: для сложных случаев форматирования

### Извлечение детальных характеристик

- Описание парфюма
- Пирамида ароматов (верхние, средние, базовые ноты)
- Доступные объемы
- Концентрация аромата

### Обработка ошибок и надежность

- Автоматические повторные попытки при сетевых ошибках
- Многопоточная обработка для ускорения парсинга
- Подробное логирование всех операций
- Сохранение отладочной информации при проблемах

### Соблюдение этики парсинга

- Задержки между запросами (1-3 секунды)
- Имитация реального браузера
- Обработка ошибок HTTP
- Уважение к robots.txt

## Статистика парсинга

После завершения работы парсер выводит подробную статистику:
- Общее количество найденных парфюмов (1281)
- Количество уникальных брендов
- Процент товаров с определенными брендами
- Топ-10 самых популярных брендов
- Количество товаров с детальными характеристиками

## Пример вывода

```
==================================================
СТАТИСТИКА ПАРСИНГА AROMA-EURO.RU (ПОЛНАЯ ВЕРСИЯ)
==================================================
Всего парфюмов: 1281
Уникальных брендов: 180+
С определенным брендом: 1200+
Без бренда: <81
С URL: 1281
С ценами: 1250+
С изображениями: 1270+
С детальными характеристиками: 1281

==================================================
ПРИМЕРЫ ЗАПИСЕЙ
==================================================

1. Tom Ford - Black Orchid
   Бренд: Tom Ford
   Название: Black Orchid
   Цена: 450 ₽
   URL: https://aroma-euro.ru/perfume/tom-ford-black-orchid/
   Описание: Роскошный восточный аромат...
   Ноты: Черная смородина, Черная орхидея, Пачули

==================================================
ТОП-10 БРЕНДОВ
==================================================
 1. Tom Ford: 89+ товаров
 2. Chanel: 67+ товаров  
 3. Dior: 54+ товаров
 4. Creed: 43+ товаров
 5. Maison Margiela: 38+ товаров
```

## Дальнейшая обработка данных

Полученные JSON файлы можно использовать для:

1. **Анализа с помощью LLM**: создание точных описаний композиций на основе детальных характеристик
2. **Создания каталогов**: импорт в базы данных или CMS с полной информацией
3. **Аналитики**: исследование рынка парфюмерии, анализ трендов
4. **Мониторинга цен**: отслеживание изменений стоимости
5. **Рекомендательных систем**: на основе пирамиды ароматов и характеристик

## Требования к системе

- Python 3.7+
- Стабильное интернет-соединение
- ~100 МБ свободного места для данных и логов
- 4+ ГБ RAM для обработки полного каталога

## Устранение неполадок

### Проблема: Парсер не находит товары

1. Проверьте доступность сайта: `curl -I https://aroma-euro.ru/perfume/`
2. Просмотрите создаваемые лог файлы
3. Проверьте подключение к интернету

### Проблема: Медленная работа

1. Парсинг полного каталога требует времени (1-2 часа)
2. Можно увеличить задержки между запросами
3. Запускайте парсер в периоды низкой нагрузки на сайт

### Проблема: Ошибки кодировки

1. Убедитесь, что терминал поддерживает UTF-8
2. На Windows используйте: `chcp 65001`

## Производительность

- **Полный каталог**: ~1-2 часа для всех 1281 товаров
- **Многопоточность**: до 5 параллельных потоков
- **Размер выходных файлов**: 
  - Базовый каталог: ~500KB
  - Полный каталог: ~700KB

## Лицензия

Этот проект предназначен только для образовательных целей. Пожалуйста, соблюдайте robots.txt сайта и не создавайте чрезмерную нагрузку на сервер.

## Контакты

При возникновении вопросов или предложений по улучшению, создайте issue в репозитории проекта.